{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Luiz.E.Costa/Desktop/Code/Curso/miniblog/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Luiz.E.Costa/Desktop/Code/Curso/miniblog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Luiz.E.Costa/Desktop/Code/Curso/miniblog/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{getAuth,createUserWithEmailAndPassword,signInWithEmailAndPassword,updateProfile,signOut}from\"firebase/auth\";import{useState,useEffect}from\"react\";export var useAuthentication=function useAuthentication(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),loading=_useState4[0],setLoading=_useState4[1];// deal with memory leak\nvar _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),cancelled=_useState6[0],setCancelled=_useState6[1];var auth=getAuth();function checkIfIsCancelled(){if(cancelled){return;}}var createUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){var _yield$createUserWith,user,systemErrorMessage;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:checkIfIsCancelled();setLoading(true);_context.prev=2;_context.next=5;return createUserWithEmailAndPassword(auth,data.email,data.password);case 5:_yield$createUserWith=_context.sent;user=_yield$createUserWith.user;_context.next=9;return updateProfile(user,{displayName:data.displayName});case 9:return _context.abrupt(\"return\",user);case 12:_context.prev=12;_context.t0=_context[\"catch\"](2);console.log(_context.t0.message);console.log(typeof _context.t0.message);if(_context.t0.message.includes(\"Password\")){systemErrorMessage=\"A senha precisa conter pelo menos 6 caracteres.\";}else if(_context.t0.message.includes(\"email-already\")){systemErrorMessage=\"E-mail já cadastrado.\";}else{systemErrorMessage=\"Ocorreu um erro, por favor tenta mais tarde.\";}setError(systemErrorMessage);case 18:setLoading(false);case 19:case\"end\":return _context.stop();}},_callee,null,[[2,12]]);}));return function createUser(_x){return _ref.apply(this,arguments);};}();var logout=function logout(){checkIfIsCancelled();signOut(auth);};var login=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(data){var systemErrorMessage;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:checkIfIsCancelled();setLoading(true);setError(false);_context2.prev=3;_context2.next=6;return signInWithEmailAndPassword(auth,data.email,data.password);case 6:_context2.next=16;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](3);console.log(_context2.t0.message);console.log(typeof _context2.t0.message);console.log(_context2.t0.message.includes(\"user-not\"));if(_context2.t0.message.includes(\"user-not-found\")){systemErrorMessage=\"Usuário não encontrado.\";}else if(_context2.t0.message.includes(\"wrong-password\")){systemErrorMessage=\"Senha incorreta.\";}else{systemErrorMessage=\"Ocorreu um erro, por favor tenta mais tarde.\";}console.log(systemErrorMessage);setError(systemErrorMessage);case 16:console.log(error);setLoading(false);case 18:case\"end\":return _context2.stop();}},_callee2,null,[[3,8]]);}));return function login(_x2){return _ref2.apply(this,arguments);};}();useEffect(function(){return function(){return setCancelled(true);};},[]);return{auth:auth,createUser:createUser,error:error,logout:logout,login:login,loading:loading};};","map":{"version":3,"names":["getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","updateProfile","signOut","useState","useEffect","useAuthentication","_useState","_useState2","_slicedToArray","error","setError","_useState3","_useState4","loading","setLoading","_useState5","_useState6","cancelled","setCancelled","auth","checkIfIsCancelled","createUser","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","data","_yield$createUserWith","user","systemErrorMessage","wrap","_callee$","_context","prev","next","email","password","sent","displayName","abrupt","t0","console","log","message","includes","stop","_x","apply","arguments","logout","login","_ref2","_callee2","_callee2$","_context2","_x2"],"sources":["C:/Users/Luiz.E.Costa/Desktop/Code/Curso/miniblog/src/hooks/useAuthentication.js"],"sourcesContent":["import {\n  getAuth,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  updateProfile,\n  signOut,\n} from \"firebase/auth\";\n\nimport { useState, useEffect } from \"react\";\n\nexport const useAuthentication = () => {\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(null);\n\n  // deal with memory leak\n  const [cancelled, setCancelled] = useState(false);\n\n  const auth = getAuth();\n\n  function checkIfIsCancelled() {\n    if (cancelled) {\n      return;\n    }\n  }\n\n  const createUser = async (data) => {\n    checkIfIsCancelled();\n\n    setLoading(true);\n\n    try {\n      const { user } = await createUserWithEmailAndPassword(\n        auth,\n        data.email,\n        data.password\n      );\n\n      await updateProfile(user, {\n        displayName: data.displayName,\n      });\n\n      return user;\n    } catch (error) {\n      console.log(error.message);\n      console.log(typeof error.message);\n\n      let systemErrorMessage;\n\n      if (error.message.includes(\"Password\")) {\n        systemErrorMessage = \"A senha precisa conter pelo menos 6 caracteres.\";\n      } else if (error.message.includes(\"email-already\")) {\n        systemErrorMessage = \"E-mail já cadastrado.\";\n      } else {\n        systemErrorMessage = \"Ocorreu um erro, por favor tenta mais tarde.\";\n      }\n\n      setError(systemErrorMessage);\n    }\n\n    setLoading(false);\n  };\n\n  const logout = () => {\n    checkIfIsCancelled();\n\n    signOut(auth);\n  };\n\n  const login = async (data) => {\n    checkIfIsCancelled();\n\n    setLoading(true);\n    setError(false);\n\n    try {\n      await signInWithEmailAndPassword(auth, data.email, data.password);\n    } catch (error) {\n      console.log(error.message);\n      console.log(typeof error.message);\n      console.log(error.message.includes(\"user-not\"));\n\n      let systemErrorMessage;\n\n      if (error.message.includes(\"user-not-found\")) {\n        systemErrorMessage = \"Usuário não encontrado.\";\n      } else if (error.message.includes(\"wrong-password\")) {\n        systemErrorMessage = \"Senha incorreta.\";\n      } else {\n        systemErrorMessage = \"Ocorreu um erro, por favor tenta mais tarde.\";\n      }\n\n      console.log(systemErrorMessage);\n\n      setError(systemErrorMessage);\n    }\n\n    console.log(error);\n\n    setLoading(false);\n  };\n\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n\n  return {\n    auth,\n    createUser,\n    error,\n    logout,\n    login,\n    loading,\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}