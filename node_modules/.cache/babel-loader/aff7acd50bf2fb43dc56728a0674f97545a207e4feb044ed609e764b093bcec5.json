{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { db } from '../firebase/config';\nimport { collection, query, orderBy, onSnapshot, where, QuerySnapshot } from 'firebase/firestore';\nexport const useFetchDocuments = function (docCollection) {\n  _s();\n  let search = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n  let uid = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  const [documents, setDocuments] = useState(null);\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(null);\n\n  //deal with memory leak\n  const [cancelled, setCancelled] = useState(false);\n  useEffect(() => {\n    async function loadData() {\n      if (cancelled) return;\n      setLoading(true);\n      const collectionRef = await collection(db, docCollection);\n      try {\n        let q;\n\n        //busca\n\n        //dashboard\n\n        q = await query(collectionRef, orderBy('createdAt', 'desc'));\n        await onSnapshot(q, QuerySnapshot => {\n          setDocuments(QuerySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n          })));\n        });\n        setLoading(false);\n      } catch (error) {\n        console.log(error);\n        setError(error.message);\n        setLoading(false);\n      }\n    }\n    loadData();\n  }, [docCollection, search, uid, cancelled]);\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n  return {\n    documents,\n    loading,\n    error\n  };\n};\n_s(useFetchDocuments, \"oHQtMVeLQvU17FI2wc7iUGDhIAM=\");","map":{"version":3,"names":["useState","useEffect","db","collection","query","orderBy","onSnapshot","where","QuerySnapshot","useFetchDocuments","docCollection","_s","search","arguments","length","undefined","uid","documents","setDocuments","error","setError","loading","setLoading","cancelled","setCancelled","loadData","collectionRef","q","docs","map","doc","id","data","console","log","message"],"sources":["C:/Users/Luiz.E.Costa/Desktop/Code/Curso/miniblog/src/hooks/useFetchDocument.js"],"sourcesContent":["import { useState, useEffect } from 'react'\r\nimport { db } from '../firebase/config'\r\nimport {\r\n    collection,\r\n    query,\r\n    orderBy,\r\n    onSnapshot,\r\n    where,\r\n    QuerySnapshot\r\n} from 'firebase/firestore'\r\n\r\nexport const useFetchDocuments = (docCollection, search = null, uid = null) => {\r\n    const [documents, setDocuments] = useState(null)\r\n    const [error, setError] = useState(null)\r\n    const [loading, setLoading] = useState(null)\r\n\r\n    //deal with memory leak\r\n    const [cancelled, setCancelled] = useState(false)\r\n\r\n    useEffect(() => {\r\n\r\n        async function loadData() {\r\n            if (cancelled) return\r\n\r\n            setLoading(true)\r\n\r\n            const collectionRef = await collection(db, docCollection)\r\n\r\n            try {\r\n\r\n                let q\r\n\r\n                //busca\r\n\r\n                //dashboard\r\n\r\n                q = await query(collectionRef, orderBy('createdAt', 'desc'))\r\n                await onSnapshot(q,(QuerySnapshot)=> {\r\n                    setDocuments(\r\n                        QuerySnapshot.docs.map(doc => ({\r\n                            id: doc.id,\r\n                            ...doc.data()\r\n                        }))\r\n                    )\r\n                })\r\n\r\n                setLoading(false)\r\n            } catch (error) {\r\n                console.log(error)\r\n                setError(error.message)\r\n                setLoading(false)\r\n            }\r\n        }\r\n\r\n        loadData()\r\n    }, [docCollection, search, uid, cancelled])\r\n\r\n    useEffect( () => {\r\n        return () => setCancelled(true)\r\n    },[])\r\n\r\n    return {documents,loading,error}\r\n}"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,EAAE,QAAQ,oBAAoB;AACvC,SACIC,UAAU,EACVC,KAAK,EACLC,OAAO,EACPC,UAAU,EACVC,KAAK,EACLC,aAAa,QACV,oBAAoB;AAE3B,OAAO,MAAMC,iBAAiB,GAAG,SAAAA,CAACC,aAAa,EAAgC;EAAAC,EAAA;EAAA,IAA9BC,MAAM,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;EAAA,IAAEG,GAAG,GAAAH,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,IAAI;EACtE,MAAM,CAACI,SAAS,EAAEC,YAAY,CAAC,GAAGlB,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACmB,KAAK,EAAEC,QAAQ,CAAC,GAAGpB,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM,CAACqB,OAAO,EAAEC,UAAU,CAAC,GAAGtB,QAAQ,CAAC,IAAI,CAAC;;EAE5C;EACA,MAAM,CAACuB,SAAS,EAAEC,YAAY,CAAC,GAAGxB,QAAQ,CAAC,KAAK,CAAC;EAEjDC,SAAS,CAAC,MAAM;IAEZ,eAAewB,QAAQA,CAAA,EAAG;MACtB,IAAIF,SAAS,EAAE;MAEfD,UAAU,CAAC,IAAI,CAAC;MAEhB,MAAMI,aAAa,GAAG,MAAMvB,UAAU,CAACD,EAAE,EAAEQ,aAAa,CAAC;MAEzD,IAAI;QAEA,IAAIiB,CAAC;;QAEL;;QAEA;;QAEAA,CAAC,GAAG,MAAMvB,KAAK,CAACsB,aAAa,EAAErB,OAAO,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;QAC5D,MAAMC,UAAU,CAACqB,CAAC,EAAEnB,aAAa,IAAI;UACjCU,YAAY,CACRV,aAAa,CAACoB,IAAI,CAACC,GAAG,CAACC,GAAG,KAAK;YAC3BC,EAAE,EAAED,GAAG,CAACC,EAAE;YACV,GAAGD,GAAG,CAACE,IAAI;UACf,CAAC,CAAC,CAAC,CACN;QACL,CAAC,CAAC;QAEFV,UAAU,CAAC,KAAK,CAAC;MACrB,CAAC,CAAC,OAAOH,KAAK,EAAE;QACZc,OAAO,CAACC,GAAG,CAACf,KAAK,CAAC;QAClBC,QAAQ,CAACD,KAAK,CAACgB,OAAO,CAAC;QACvBb,UAAU,CAAC,KAAK,CAAC;MACrB;IACJ;IAEAG,QAAQ,EAAE;EACd,CAAC,EAAE,CAACf,aAAa,EAAEE,MAAM,EAAEI,GAAG,EAAEO,SAAS,CAAC,CAAC;EAE3CtB,SAAS,CAAE,MAAM;IACb,OAAO,MAAMuB,YAAY,CAAC,IAAI,CAAC;EACnC,CAAC,EAAC,EAAE,CAAC;EAEL,OAAO;IAACP,SAAS;IAACI,OAAO;IAACF;EAAK,CAAC;AACpC,CAAC;AAAAR,EAAA,CAnDYF,iBAAiB"},"metadata":{},"sourceType":"module","externalDependencies":[]}