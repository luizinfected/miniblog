{"ast":null,"code":"import _slicedToArray from\"C:/Users/Luiz.E.Costa/Desktop/Code/Curso/miniblog/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import styles from\"./EditPost.module.css\";import{useState,useEffect}from\"react\";import{useNavigate,useParams}from\"react-router-dom\";import{useAuthValue}from\"../../contexts/AuthContext\";import{useFetchDocument}from\"../../hooks/useFetchDocument\";import{useUpdateDocument}from\"../../hooks/useUpdateDocument\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var EditPost=function EditPost(){var _useParams=useParams(),id=_useParams.id;var _useFetchDocument=useFetchDocument(\"posts\",id),post=_useFetchDocument.document;console.log(post);var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),image=_useState4[0],setImage=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),body=_useState6[0],setBody=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),tags=_useState8[0],setTags=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),formError=_useState10[0],setFormError=_useState10[1];// fill form data\nuseEffect(function(){if(post){setTitle(post.title);setImage(post.image);setBody(post.body);var textTags=post.tags.join(\", \");setTags(textTags);}},[post]);var _useAuthValue=useAuthValue(),user=_useAuthValue.user;console.log(user);var navigate=useNavigate();var _useUpdateDocument=useUpdateDocument(\"posts\"),updateDocument=_useUpdateDocument.updateDocument,response=_useUpdateDocument.response;var handleSubmit=function handleSubmit(e){e.preventDefault();setFormError(\"\");// validate image\ntry{new URL(image);}catch(error){setFormError(\"A imagem precisa ser uma URL.\");}// create tags array\nvar tagsArray=tags.split(\",\").map(function(tag){return tag.trim();});console.log(tagsArray);console.log({title:title,image:image,body:body,tags:tagsArray});var data={title:title,image:image,body:body,tags:tagsArray};console.log(post);updateDocument(id,data);// redirect to home page\nnavigate(\"/dashboard\");};return/*#__PURE__*/_jsx(\"div\",{className:styles.edit_post,children:post&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Editando post: \",post.title]}),/*#__PURE__*/_jsx(\"p\",{children:\"Altere os dados do post como desejar\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"T\\xEDtulo:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"text\",required:true,placeholder:\"Pense num bom t\\xEDtulo...\",onChange:function onChange(e){return setTitle(e.target.value);},value:title})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"URL da imagem:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"image\",required:true,placeholder:\"Insira uma imagem que representa seu post\",onChange:function onChange(e){return setImage(e.target.value);},value:image})]}),/*#__PURE__*/_jsx(\"p\",{className:styles.preview_title,children:\"Preview da imagem atual:\"}),/*#__PURE__*/_jsx(\"img\",{className:styles.image_preview,src:post.image,alt:post.title}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Conte\\xFAdo:\"}),/*#__PURE__*/_jsx(\"textarea\",{name:\"body\",required:true,placeholder:\"Insira o conte\\xFAdo do post\",onChange:function onChange(e){return setBody(e.target.value);},value:body})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"span\",{children:\"Tags:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"tags\",required:true,placeholder:\"Insira as tags separadas por v\\xEDrgula\",onChange:function onChange(e){return setTags(e.target.value);},value:tags})]}),!response.loading&&/*#__PURE__*/_jsx(\"button\",{className:\"btn\",children:\"Editar\"}),response.loading&&/*#__PURE__*/_jsx(\"button\",{className:\"btn\",disabled:true,children:\"Aguarde.. .\"}),(response.error||formError)&&/*#__PURE__*/_jsx(\"p\",{className:\"error\",children:response.error||formError})]})]})});};export default EditPost;","map":{"version":3,"names":["styles","useState","useEffect","useNavigate","useParams","useAuthValue","useFetchDocument","useUpdateDocument","jsxs","_jsxs","jsx","_jsx","Fragment","_Fragment","EditPost","_useParams","id","_useFetchDocument","post","document","console","log","_useState","_useState2","_slicedToArray","title","setTitle","_useState3","_useState4","image","setImage","_useState5","_useState6","body","setBody","_useState7","_useState8","tags","setTags","_useState9","_useState10","formError","setFormError","textTags","join","_useAuthValue","user","navigate","_useUpdateDocument","updateDocument","response","handleSubmit","e","preventDefault","URL","error","tagsArray","split","map","tag","trim","data","className","edit_post","children","onSubmit","type","name","required","placeholder","onChange","target","value","preview_title","image_preview","src","alt","loading","disabled"],"sources":["C:/Users/Luiz.E.Costa/Desktop/Code/Curso/miniblog/src/pages/EditPost/EditPost.js"],"sourcesContent":["import styles from \"./EditPost.module.css\";\n\nimport { useState, useEffect } from \"react\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { useAuthValue } from \"../../contexts/AuthContext\";\nimport { useFetchDocument } from \"../../hooks/useFetchDocument\";\nimport { useUpdateDocument } from \"../../hooks/useUpdateDocument\";\n\nconst EditPost = () => {\n  const { id } = useParams();\n  const { document: post } = useFetchDocument(\"posts\", id);\n\n  console.log(post);\n\n  const [title, setTitle] = useState(\"\");\n  const [image, setImage] = useState(\"\");\n  const [body, setBody] = useState(\"\");\n  const [tags, setTags] = useState([]);\n  const [formError, setFormError] = useState(\"\");\n\n  // fill form data\n  useEffect(() => {\n    if (post) {\n      setTitle(post.title);\n      setImage(post.image);\n      setBody(post.body);\n\n      const textTags = post.tags.join(\", \");\n\n      setTags(textTags);\n    }\n  }, [post]);\n\n  const { user } = useAuthValue();\n  console.log(user)\n  const navigate = useNavigate();\n\n  const { updateDocument, response } = useUpdateDocument(\"posts\");\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    setFormError(\"\");\n\n    // validate image\n    try {\n      new URL(image);\n    } catch (error) {\n      setFormError(\"A imagem precisa ser uma URL.\");\n    }\n\n    // create tags array\n    const tagsArray = tags.split(\",\").map((tag) => tag.trim());\n\n    console.log(tagsArray);\n\n    console.log({\n      title,\n      image,\n      body,\n      tags: tagsArray,\n    });\n\n    const data = {\n      title,\n      image,\n      body,\n      tags: tagsArray,\n    };\n\n    console.log(post);\n\n    updateDocument(id, data);\n\n    // redirect to home page\n    navigate(\"/dashboard\");\n  };\n\n  return (\n    <div className={styles.edit_post}>\n      {post && (\n        <>\n          <h2>Editando post: {post.title}</h2>\n          <p>Altere os dados do post como desejar</p>\n          <form onSubmit={handleSubmit}>\n            <label>\n              <span>Título:</span>\n              <input\n                type=\"text\"\n                name=\"text\"\n                required\n                placeholder=\"Pense num bom título...\"\n                onChange={(e) => setTitle(e.target.value)}\n                value={title}\n              />\n            </label>\n            <label>\n              <span>URL da imagem:</span>\n              <input\n                type=\"text\"\n                name=\"image\"\n                required\n                placeholder=\"Insira uma imagem que representa seu post\"\n                onChange={(e) => setImage(e.target.value)}\n                value={image}\n              />\n            </label>\n            <p className={styles.preview_title}>Preview da imagem atual:</p>\n            <img\n              className={styles.image_preview}\n              src={post.image}\n              alt={post.title}\n            />\n            <label>\n              <span>Conteúdo:</span>\n              <textarea\n                name=\"body\"\n                required\n                placeholder=\"Insira o conteúdo do post\"\n                onChange={(e) => setBody(e.target.value)}\n                value={body}\n              ></textarea>\n            </label>\n            <label>\n              <span>Tags:</span>\n              <input\n                type=\"text\"\n                name=\"tags\"\n                required\n                placeholder=\"Insira as tags separadas por vírgula\"\n                onChange={(e) => setTags(e.target.value)}\n                value={tags}\n              />\n            </label>\n            {!response.loading && <button className=\"btn\">Editar</button>}\n            {response.loading && (\n              <button className=\"btn\" disabled>\n                Aguarde.. .\n              </button>\n            )}\n            {(response.error || formError) && (\n              <p className=\"error\">{response.error || formError}</p>\n            )}\n          </form>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default EditPost;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}